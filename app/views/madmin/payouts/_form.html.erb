<div class="payout-form-container">
  <%= form_with model: [:madmin, record],
        url: (record.persisted? ? resource.show_path(record) : resource.index_path),
        local: true do |form| %>
    <% if form.object.errors.any? %>
      <div class="alert alert-danger">
        <div class="">
          There was <%= pluralize form.object.errors.full_messages.count, "error" %> with your submission:
        </div>

        <ul>
          <% form.object.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="form-group">
      <%= form.label :account_id %>
      <%= form.collection_select :account_id,
            @accounts,
            :id,
            :to_s,
            {prompt: "Select an account"},
            {class: "form-control"} %>
    </div>

    <% visible_attrs = resource.attributes.values.select do |attr|
         attr.field.present? && attr.field.visible?(action_name) && attr.name != :account
       end %>

    <% visible_attrs.each do |attribute| %>
      <div class="form-group">
        <%= render "madmin/shared/label", form: form, field: attribute.field %>
        <%= render partial: attribute.field.to_partial_path("form"),
              locals: {field: attribute.field, record: record, form: form, resource: resource} %>
        <% if attribute.field.options.description.present? %>
          <%= tag.div attribute.field.options.description, class: "form-description" %>
        <% end %>
      </div>
    <% end %>

    <%= form.submit class: "btn btn-primary" %>
    <%= link_to "Cancel", (record.persisted? ? resource.show_path(record) : resource.index_path), class: "btn" %>
  <% end %>
</div>
